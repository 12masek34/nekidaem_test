
# Реализовать rest api:

* Имеется база пользователей (добавляются через админку/swagger, регистрацию делать не надо).
* У каждого пользователя при создании создается персональный блог. Новые создавать он не может.
* Пост в блоге — элементарная запись с заголовком, текстом (140 символов) и временем создания. Заголовок обязательное поле.
* Пользователь может подписываться/отписываться на блоги других пользователей (любое количество).
* У пользователя есть персональная лента новостей (не более ~500 постов), в которой выводятся посты из блогов,
 на которые он подписан, в порядке добавления постов. Пагинация по 10 постов.
* Пользователь может помечать посты в ленте прочитанными.
* При удалении/добавлении поста, лента тоже должна изменяться
* Раз в сутки на почту прилетает подборка из 5 последних постов ленты (можно в консоль)
* В среднем пользователь подписан на 100 человек, которые постят по 2-3 раза в день.
* Предполагаемое кол-во пользователей в системе около 1 млн.
---
### Структура:
* PostgreSQL - Основное хранилище. Тут хранятся все таблицы с пользователями, блогами и постами.
* Redis - В качестве кэш. Когда пользователь помечает в ленте пост как прочитанный, он добавляется в редис.
* Сервер FastAPI. ORM SqlAlchemy. по пути http://localhost:8000/docs доступен свагер.
* Модуль mailing.py, программа "демон", запускается в отдельном процессе, выполняет рассылку по таймеру (установлен на 10:00).
(Просто печатает в консоль).
---
При старте, программа создает 1_000 пользователей и блогов, в каждом блоге еще по 10 постов. (Это можно настроить в модуле models.load_data.py)

### Запуск

```commandline
docker-compose up
```

### Маршруты

* http://0.0.0.0:8000/user/add - добавляет юзера и блог.
* http://0.0.0.0:8000/sumscribe - добавляет юзеру подписку на блог.
* http://0.0.0.0:8000/unscribe - удаляет юзеру подписку на блог.
* http://0.0.0.0:8000/user/all - все юзеры (используется для рассылки)
* http://0.0.0.0:8000/tape/<id> - лента, посты всех блогов, на которы подписан юзер в хронологическом порядке.
* http://0.0.0.0:8000/tape/limit_5/<id> - последние 5 постов ленты.
---

P.S. Приложение реализовано как MVP. С точки зрения эффективности можно провести много улучшение. Сократить лишние запросы к бд, добавить пагинацию к "большим" запросам и т.д.   

